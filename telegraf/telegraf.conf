[agent]
  interval = "10s"
  omit_hostname = true

[[outputs.influxdb_v2]]
  urls = ["http://influxdb:8086"]
  token = "my-super-secret-token"
  organization = "home"
  bucket = "govee"

[[inputs.mqtt_consumer]]
  servers = ["tcp://mosquitto:1883"]
  topics = [
    "gv2mqtt/sensor/+/state"
  ]
  data_format = "value"
  data_type = "float"
  topic_tag = "topic"

[[processors.regex]]
  [[processors.regex.tags]]
    key = "topic"
    pattern = "gv2mqtt/sensor/sensor-([A-F0-9]+)-sensor([a-z]+)/state"
    replacement = "${1}"
    result_key = "z_device_id"

  [[processors.regex.tags]]
    key = "topic"
    pattern = "gv2mqtt/sensor/sensor-([A-F0-9]+)-sensor([a-z]+)/state"
    replacement = "${2}"
    result_key = "sensor_type"

[[processors.enum]]
  [[processors.enum.mapping]]
    tag = "z_device_id"
    dest = "device_name"
    [processors.enum.mapping.value_mappings]
      "17A8D003C1061976" = "floor_lamp_upper"
      "D278A4C138504E6F" = "h5074_4e6f"
      "33FA4381ECA1010A" = "studio_5051_down"
      "19544381ECB1405D" = "5051_studio_up"

  [[processors.enum.mapping]]
    tag = "device_id"
    dest = "room"
    [processors.enum.mapping.value_mappings]
      "17A8D003C1061976" = "studiodown"
      "D278A4C138504E6F" = "studiodown"
      "33FA4381ECA1010A" = "studiodown"
      "19544381ECB1405D" = "studioup"
